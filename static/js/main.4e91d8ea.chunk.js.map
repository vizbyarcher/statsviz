{"version":3,"sources":["App.js","index.js"],"names":["TableStyle","createGlobalStyle","fetchURL","initialState","reducer","state","action","console","log","type","updated","payload","index","newValue","Array","length","fill","Error","CustomContext","React","createContext","ComboSelect","props","codeParams","code","useState","jstat","setJstat","setData","customContext","useContext","params","paramLink","link","includes","forEach","element","key","p","Object","entries","reduce","accumulator","value","slice","useEffect","fetch","then","res","json","result","JSONstat","toTable","JSONstatUtils","JstatTable","dangerouslySetInnerHTML","__html","map","item","d","l","Autocomplete","id","String","debug","options","v","getOptionLabel","option","style","width","onChange","event","dispatch","renderInput","TextField","label","variant","fullWidth","App","valueFirst","setValueFirst","euro","setEuro","codes","setCodes","setCode","setCodeParams","useReducer","className","Provider","cont","filter","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"iQAQMA,EAAaC,YAAH,0RAqBVC,EACL,yFAYKC,EAAe,GAEfC,EAAU,WAAmC,IAAlCC,EAAiC,uDAAzBF,EAAcG,EAAW,uCAEjD,OADAC,QAAQC,IAAI,WAAYH,GAChBC,EAAOG,MACd,IAAK,SACJ,IAAIC,EAAO,YAAOL,GAIlB,OAHAE,QAAQC,IAAI,kBAAmBE,GAC/BA,EAAQJ,EAAOK,QAAQC,OAASN,EAAOK,QAAQE,SAC/CN,QAAQC,IAAI,iBAAkBE,GACvBA,EACR,IAAK,QACJ,OAAO,IAAII,MAAMR,EAAOK,QAAQI,QAAQC,KAAK,MAC9C,QACC,MAAM,IAAIC,QAGPC,EAAgBC,IAAMC,gBAEtBC,EAAc,SAAAC,GAAU,IACrBC,EAAqBD,EAArBC,WAAYC,EAASF,EAATE,KADQ,EAGFC,mBAAS,MAHP,mBAGrBC,EAHqB,KAGdC,EAHc,OAIJF,mBAAS,MAJL,mBAIfG,GAJe,WAK5BrB,QAAQC,IAAI,6BAA8Be,EAAWR,QACrD,IAAMc,EAAgBC,qBAAWZ,GACjCX,QAAQC,IAAI,wBAAyBqB,EAAcxB,OACnD,IAAI0B,EAAS,KACTC,EAAY,KACZC,EAAO,KACX,GAAIJ,EAAcxB,MAAMU,OAAS,IAAMc,EAAcxB,MAAM6B,SAAS,MAAO,CAC1E3B,QAAQC,IAAI,yBACZuB,EAAS,GACTxB,QAAQC,IAAI,cAAee,GAC3BA,EAAWY,SAAQ,SAACC,EAASxB,GAC5B,IAAIyB,EAAMD,EAAQE,EAClBP,EAAOM,GAAOR,EAAcxB,MAAMO,MAEnCL,QAAQC,IAAI,UAAWuB,GAGvBC,EAAYO,OAAOC,QAAQT,GAAQU,QAFX,SAACC,EAAaC,GAAd,OACvBD,EAAc,IAAMC,EAAM,GAAK,IAAMA,EAAM,KACe,IAC3DV,EAAI,oEAAgET,EAAhE,YAAwEQ,EAAUY,MACrF,GADG,gBAGJrC,QAAQC,IAAI,OAAQyB,GAErBY,qBAAU,WACLZ,EACHa,MAAMb,GACJc,MAAK,SAAAC,GAAG,OAAIA,EAAIC,UAChBF,MAAK,SAAAC,GACL,IAAIE,EAASC,YAASH,GAAKI,QAAQ,CAAE3C,KAAM,WAG3C,OAFAF,QAAQC,IAAI,WAAY0C,GACxBtB,EAAQsB,GACDF,KAEPD,MAAK,SAAAC,GAAG,OAAIK,IAAuBF,YAASH,OAC5CD,MAAK,SAAAC,GACLrB,EAASqB,OAIXpB,EAAQ,MACRD,EAAS,SAER,CAACM,IACJ,IAAMqB,EAAa,kBAClB,qBAAKC,wBAAyB,CAAEC,OAAQ9B,MAGzC,OACC,gCACEH,EAAWkC,KAAI,SAACC,EAAM9C,GAAP,OACf,gCACC,gCAAM8C,EAAKC,EAAEC,EAAb,OACA,uBACA,cAACC,EAAA,EAAD,CACCC,GAAIC,OAAOnD,GAEXoD,OAAO,EACPC,QAASP,EAAKC,EAAEO,EAChBC,eAAgB,SAAAC,GAAM,OAAIA,GAC1BzB,MAAOd,EAAcxB,MAAMO,GAG3ByD,MAAO,CAAEC,MAAO,KAChBC,SAAU,SAACC,EAAO7B,GACjBpC,QAAQC,IAAR,iBAAsBmC,IAClBA,EACHd,EAAc4C,SAAS,CACtBhE,KAAM,SACNE,QAAS,CAAEC,MAAOA,EAAOC,SAAU8B,KAIpCd,EAAc4C,SAAS,CACtBhE,KAAM,SACNE,QAAS,CAAEC,MAAOA,EAAOC,SAAU,SAKtC6D,YAAa,SAAAnD,GAAU,OACtB,cAACoD,EAAA,EAAD,2BACKpD,GADL,IAECqD,MAAOlB,EAAKpB,EACZuC,QAAQ,WACRC,WAAS,OA7BNf,OAAOnD,IAiCb,yBAtCS,SAAWmD,OAAOnD,OAyC7B,uBACCmB,GAAU,8BAAME,IACjB,uBACA,cAACjC,EAAD,IACCiC,GAAQ,cAACqB,EAAD,QAKG,SAASyB,IAAO,IAAD,EACOtD,mBAAS,MADhB,mBACtBuD,EADsB,KACVC,EADU,OAELxD,mBAAS,IAFJ,mBAEtByD,EAFsB,KAEhBC,EAFgB,OAGH1D,mBAAS,IAHN,mBAGtB2D,EAHsB,KAGfC,EAHe,OAIL5D,mBAAS,MAJJ,mBAItBD,EAJsB,KAIhB8D,EAJgB,OAMO7D,mBAAS,MANhB,mBAMtBF,EANsB,KAMVgE,EANU,OAQHC,qBAAWpF,EAASD,GARjB,mBAQtBE,EARsB,KAQfoE,EARe,KAiC7B,OAXAlE,QAAQC,IAAI,sBACZqC,qBAAU,WACTC,MAAM5C,GACJ6C,MAAK,SAAAC,GAAG,OAAIA,EAAIC,UAChBF,MAAK,SAAAC,GACLmC,EAAQnC,GAERqC,EAASrC,EAAIS,KAAI,SAAAC,GAAI,OAAIA,EAAKI,YAE9B,IAGF,qBAAK2B,UAAU,MAAf,SACC,eAACvE,EAAcwE,SAAf,CAAwB/C,MAAO,CAAEtC,MAAOA,EAAOoE,SAAUA,GAAzD,UACC,mDAECW,GACA,cAACvB,EAAA,EAAD,CACCC,GAAG,kBACHG,QAASmB,EACTjB,eAAgB,SAAAC,GAAM,OAAIA,GAC1BzB,MAAOqC,EACPX,MAAO,CAAEC,MAAO,KAChBC,SAAU,SAACC,EAAO7B,GAEjB,GAAIA,EAAO,CAEV2C,EAAQ3C,GAERsC,EAActC,GACd,IAAIgD,EAAOT,EAAKU,QAAO,SAAAlC,GAAI,OAAIA,EAAKI,KAAOnB,KAAO,GAAvC,EAGX4C,EAAcI,GACdpF,QAAQC,IAAI,cAAee,GAC3BkD,EAAS,CAAEhE,KAAM,QAASE,QAAS,CAAEI,OAAQ4E,EAAK5E,UAClDR,QAAQC,IAAI,SAAUH,QAGtBiF,EAAQ,MACRL,EAAc,MAEdM,EAAc,IACdd,EAAS,CAAEhE,KAAM,QAASE,QAAS,CAAEI,OAAQ,KAC7CR,QAAQC,IAAI,SAAUH,IAGxBqE,YAAa,SAAA3C,GAAM,OAClB,cAAC4C,EAAA,EAAD,2BACK5C,GADL,IAEC6C,MAAM,6BACNC,QAAQ,WACRC,WAAS,QAKb,uBAGA,uBACCvD,GACA,cAAC,EAAD,CAAaA,WAAYA,EAAYC,KAAMA,EAAMnB,MAAOA,SCrP7DwF,IAASC,OACR,cAAC,IAAMC,WAAP,UACC,cAAChB,EAAD,MAEDiB,SAASC,eAAe,W","file":"static/js/main.4e91d8ea.chunk.js","sourcesContent":["import React, { useEffect, useState, useReducer, useContext } from 'react'\nimport { TextField } from '@material-ui/core'\nimport Autocomplete from '@material-ui/lab/Autocomplete'\n// import * as EuroJSONstat from 'jsonstat-euro'\nimport JSONstat from 'jsonstat-toolkit'\nimport * as JSONstatUtils from 'jsonstat-suite'\nimport { createGlobalStyle } from 'styled-components'\n\nconst TableStyle = createGlobalStyle`\n  table {\n  width: 100%;\n  border: 1px solid black;\n  border-collapse: collapse;\n  th,\n  td {\n    border: 1px solid black;\n    border-collapse: collapse;\n  }\n  th,\n  td,\n  tr {\n    padding: 5px;\n  }\n  th {\n    text-align: left;\n  }\n  }\n`\n\nconst fetchURL =\n\t'https://raw.githubusercontent.com/vizbyarcher/statsviz/gh-pages/data/es/euro_meta.json'\nconst getItems = () => fetch(fetchURL).then(res => res.json())\n\nconst query = {\n\tlang: 'en',\n\tdataset: 'tec00001',\n\tfilter: {\n\t\tna_item: ['B1GQ'],\n\t\tunit: ['CP_EUR_HAB'],\n\t},\n}\n\nconst initialState = []\n\nconst reducer = (state = initialState, action) => {\n\tconsole.log('reducer:', state)\n\tswitch (action.type) {\n\t\tcase 'update':\n\t\t\tlet updated = [...state]\n\t\t\tconsole.log('previous state:', updated)\n\t\t\tupdated[action.payload.index] = action.payload.newValue\n\t\t\tconsole.log('updated state:', updated)\n\t\t\treturn updated\n\t\tcase 'reset':\n\t\t\treturn new Array(action.payload.length).fill(null)\n\t\tdefault:\n\t\t\tthrow new Error()\n\t}\n}\nconst CustomContext = React.createContext()\n\nconst ComboSelect = props => {\n\tconst { codeParams, code } = props\n\t// const [jstat, setJstat] = useState([])\n\tconst [jstat, setJstat] = useState(null)\n\tconst [data, setData] = useState(null)\n\tconsole.log('ComboSelect is rendered...', codeParams.length)\n\tconst customContext = useContext(CustomContext)\n\tconsole.log('state in ComboSelect:', customContext.state)\n\tlet params = null\n\tlet paramLink = null\n\tlet link = null\n\tif (customContext.state.length > 0 && !customContext.state.includes(null)) {\n\t\tconsole.log('every param selected!')\n\t\tparams = {}\n\t\tconsole.log('codeParams:', codeParams)\n\t\tcodeParams.forEach((element, index) => {\n\t\t\tlet key = element.p\n\t\t\tparams[key] = customContext.state[index]\n\t\t})\n\t\tconsole.log('params:', params)\n\t\tconst reducerFunction = (accumulator, value) =>\n\t\t\taccumulator + '&' + value[0] + '=' + value[1]\n\t\tparamLink = Object.entries(params).reduce(reducerFunction, '')\n\t\tlink = `https://ec.europa.eu/eurostat/wdds/rest/data/v2.1/json/en/${code}?${paramLink.slice(\n\t\t\t1\n\t\t)}&precision=1`\n\t\tconsole.log('link', link)\n\t}\n\tuseEffect(() => {\n\t\tif (link) {\n\t\t\tfetch(link)\n\t\t\t\t.then(res => res.json())\n\t\t\t\t.then(res => {\n\t\t\t\t\tlet result = JSONstat(res).toTable({ type: 'arrobj' })\n\t\t\t\t\tconsole.log('testing:', result)\n\t\t\t\t\tsetData(result)\n\t\t\t\t\treturn res\n\t\t\t\t})\n\t\t\t\t.then(res => JSONstatUtils.datalist(JSONstat(res)))\n\t\t\t\t.then(res => {\n\t\t\t\t\tsetJstat(res)\n\t\t\t\t\t// console.log('jstat:', res)\n\t\t\t\t})\n\t\t} else {\n\t\t\tsetData(null)\n\t\t\tsetJstat(null)\n\t\t}\n\t}, [link])\n\tconst JstatTable = () => (\n\t\t<div dangerouslySetInnerHTML={{ __html: jstat }}></div>\n\t)\n\n\treturn (\n\t\t<div>\n\t\t\t{codeParams.map((item, index) => (\n\t\t\t\t<div key={'index-' + String(index)}>\n\t\t\t\t\t<div>{item.d.l}:</div>\n\t\t\t\t\t<br></br>\n\t\t\t\t\t<Autocomplete\n\t\t\t\t\t\tid={String(index)}\n\t\t\t\t\t\tkey={String(index)}\n\t\t\t\t\t\tdebug={true}\n\t\t\t\t\t\toptions={item.d.v}\n\t\t\t\t\t\tgetOptionLabel={option => option}\n\t\t\t\t\t\tvalue={customContext.state[index]}\n\t\t\t\t\t\t// defaultValue={null}\n\t\t\t\t\t\t// inputValue={valueSelected[index]}\n\t\t\t\t\t\tstyle={{ width: 380 }}\n\t\t\t\t\t\tonChange={(event, value) => {\n\t\t\t\t\t\t\tconsole.log(`value: ${value}`)\n\t\t\t\t\t\t\tif (value) {\n\t\t\t\t\t\t\t\tcustomContext.dispatch({\n\t\t\t\t\t\t\t\t\ttype: 'update',\n\t\t\t\t\t\t\t\t\tpayload: { index: index, newValue: value },\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t// console.log('custom context:', customContext.state)\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tcustomContext.dispatch({\n\t\t\t\t\t\t\t\t\ttype: 'update',\n\t\t\t\t\t\t\t\t\tpayload: { index: index, newValue: null },\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t// console.log('custom context:', customContext.state)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}}\n\t\t\t\t\t\trenderInput={codeParams => (\n\t\t\t\t\t\t\t<TextField\n\t\t\t\t\t\t\t\t{...codeParams}\n\t\t\t\t\t\t\t\tlabel={item.p}\n\t\t\t\t\t\t\t\tvariant='outlined'\n\t\t\t\t\t\t\t\tfullWidth\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t)}\n\t\t\t\t\t/>\n\t\t\t\t\t<br></br>\n\t\t\t\t</div>\n\t\t\t))}\n\t\t\t<br></br>\n\t\t\t{params && <div>{link}</div>}\n\t\t\t<br></br>\n\t\t\t<TableStyle />\n\t\t\t{link && <JstatTable />}\n\t\t</div>\n\t)\n}\n\nexport default function App() {\n\tconst [valueFirst, setValueFirst] = useState(null)\n\tconst [euro, setEuro] = useState([])\n\tconst [codes, setCodes] = useState([])\n\tconst [code, setCode] = useState(null)\n\t// const [content, setContent] = useState(null)\n\tconst [codeParams, setCodeParams] = useState(null)\n\n\tconst [state, dispatch] = useReducer(reducer, initialState)\n\t// useEffect(() => {\n\t// \tEuroJSONstat.fetchDataset('une_rt_a').then(ds => {\n\t// \t\tconst statusId = ds.Data({\n\t// \t\t\t\tgeo: 'AT',\n\t// \t\t\t\ttime: '1983',\n\t// \t\t\t\tsex: 'T',\n\t// \t\t\t\tage: 'TOTAL',\n\t// \t\t\t\tunit: 'PC_ACT',\n\t// \t\t\t}).status,\n\t// \t\t\tstatusLabel = EuroJSONstat.getStatusLabel(ds, statusId)\n\t// \t\tconsole.log(`\"${statusId}\" = \"${statusLabel}\"`)\n\t// \t})\n\t// }, [])\n\tconsole.log('App is rendered...')\n\tuseEffect(() => {\n\t\tfetch(fetchURL)\n\t\t\t.then(res => res.json())\n\t\t\t.then(res => {\n\t\t\t\tsetEuro(res)\n\t\t\t\t// console.log('euro:', res)\n\t\t\t\tsetCodes(res.map(item => item.id))\n\t\t\t})\n\t}, [])\n\n\treturn (\n\t\t<div className='App'>\n\t\t\t<CustomContext.Provider value={{ state: state, dispatch: dispatch }}>\n\t\t\t\t<h1>Eurostat Datasets</h1>\n\t\t\t\t{/* <Select options={codes} /> */}\n\t\t\t\t{codes && (\n\t\t\t\t\t<Autocomplete\n\t\t\t\t\t\tid='combo-box-first'\n\t\t\t\t\t\toptions={codes}\n\t\t\t\t\t\tgetOptionLabel={option => option}\n\t\t\t\t\t\tvalue={valueFirst}\n\t\t\t\t\t\tstyle={{ width: 380 }}\n\t\t\t\t\t\tonChange={(event, value) => {\n\t\t\t\t\t\t\t// console.log(`first: ${value}`)\n\t\t\t\t\t\t\tif (value) {\n\t\t\t\t\t\t\t\t// console.log('changing first value', value)\n\t\t\t\t\t\t\t\tsetCode(value)\n\t\t\t\t\t\t\t\t// console.log('code:', value)\n\t\t\t\t\t\t\t\tsetValueFirst(value)\n\t\t\t\t\t\t\t\tlet cont = euro.filter(item => item.id === value)[0]['f']\n\t\t\t\t\t\t\t\t// console.log('cont:', cont)\n\t\t\t\t\t\t\t\t// setContent(cont)\n\t\t\t\t\t\t\t\tsetCodeParams(cont)\n\t\t\t\t\t\t\t\tconsole.log('codeParams:', codeParams)\n\t\t\t\t\t\t\t\tdispatch({ type: 'reset', payload: { length: cont.length } })\n\t\t\t\t\t\t\t\tconsole.log('state:', state)\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t// console.log('no first value...')\n\t\t\t\t\t\t\t\tsetCode(null)\n\t\t\t\t\t\t\t\tsetValueFirst(null)\n\t\t\t\t\t\t\t\t// setContent(null)\n\t\t\t\t\t\t\t\tsetCodeParams([])\n\t\t\t\t\t\t\t\tdispatch({ type: 'reset', payload: { length: 0 } })\n\t\t\t\t\t\t\t\tconsole.log('state:', state)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}}\n\t\t\t\t\t\trenderInput={params => (\n\t\t\t\t\t\t\t<TextField\n\t\t\t\t\t\t\t\t{...params}\n\t\t\t\t\t\t\t\tlabel='Select Eurostat indicator:'\n\t\t\t\t\t\t\t\tvariant='outlined'\n\t\t\t\t\t\t\t\tfullWidth\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t)}\n\t\t\t\t\t/>\n\t\t\t\t)}\n\t\t\t\t<br></br>\n\t\t\t\t{/* {code && <div> {code} </div>} */}\n\t\t\t\t{/* {content && <p> {content.map(item => item.p).join()} </p>} */}\n\t\t\t\t<br></br>\n\t\t\t\t{codeParams && (\n\t\t\t\t\t<ComboSelect codeParams={codeParams} code={code} state={state} />\n\t\t\t\t)}\n\t\t\t</CustomContext.Provider>\n\t\t</div>\n\t)\n}\n","import React from 'react'\nimport ReactDOM from 'react-dom'\nimport './index.css'\nimport App from './App'\n\nReactDOM.render(\n\t<React.StrictMode>\n\t\t<App />\n\t</React.StrictMode>,\n\tdocument.getElementById('root')\n)\n"],"sourceRoot":""}